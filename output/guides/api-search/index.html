<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>API | Search a PID</title>
  <link rel="alternate" type="application/atom+xml" title="API Changes" href="/changes.atom" />
  <link href="/css/reset.css" rel="stylesheet" type="text/css" />
  <link href="/css/960.css" rel="stylesheet" type="text/css" />
  <link href="/css/uv_active4d.css" rel="stylesheet" type="text/css" />
  <link href="/shared/css/documentation.css" media="screen" rel="stylesheet" type="text/css">
  <link href="/shared/css/pygments.css" media="screen" rel="stylesheet" type="text/css">
  <script src="/shared/js/jquery.js" type="text/javascript"></script>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans+Condensed:700,300,300italic' rel='stylesheet' type='text/css'>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
<!-- Optional theme -->
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
<!-- Latest compiled and minified JavaScript -->
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

<script>
  $(function () {
    $('#myTab a:last').tab('show')
  })
</script>


<body class="api">
  <nav role="navigation" class="navbar navbar-default">
  <div class="container">
    <div class="navbar-header">
      <button data-target=".bs-navbar-collapse" data-toggle="collapse" type="button" class="navbar-toggle">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Epic Api</a>
    </div>
    <nav role="navigation" class="collapse navbar-collapse bs-navbar-collapse">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="/guides/overview" class="nav-overview"><span class="glyphicon glyphicon-list-alt"></span> Overview</a></li>
        <li><a href="/guides/api/" class="nav-api"><span class="glyphicon glyphicon-wrench"></span> API</a></li>
        <li><a href="/guides/glossary/" class="nav-blog"><span class="glyphicon glyphicon-sort-by-alphabet"></span> Glossary</a></li>
      </ul>
    </nav>
  </div>
</nav>
<!--<div id="header-wrapper">
-->
<!--  <div id="header">
    <div>
      <a class="logo" href="/">GRNET PID Service</a>
      <ul class="nav">
        <li><a href="/guides/overview" class="nav-overview">Overview</a></li>
        <li><a href="/guides/api/" class="nav-api">API</a></li>
        <li><a href="/guides/glossary/" class="nav-blog">Glossary</a></li>
      </ul>
    </div>
    </div>
    </div>
-->


  <div id="wrapper">
    <div class="content">
      <h1 id="api---search-a-pid">API - Search a PID</h1>

<p>This API uses JSON as the primary exchange format. All implementations MUST be able to produce and consume JSON.</p>

<h2 id="search-a-pid---description">Search a PID - Description</h2>
<p>You can search for a PID by using a term. </p>

<table>
  <tbody>
    <tr>
      <td><strong>Description</strong></td>
      <td>Search a PID</td>
    </tr>
    <tr>
      <td><strong>URL</strong></td>
      <td>The GRNET EPIC API Url+?PARAMETER=*term*</td>
    </tr>
    <tr>
      <td><strong>HTTP Method</strong></td>
      <td>GET</td>
    </tr>
    <tr>
      <td><strong>Security</strong></td>
      <td>You must authenticate before actually getting this information.</td>
    </tr>
  </tbody>
</table>

<p>The parameters you may use for a search request are described in the following table:</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Value</th>
      <th>Description</th>
      <th>Example value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>INST</td>
      <td>string: name of the INST</td>
      <td>Search and get the list of PIDs registered by an institute</td>
      <td>https://epic.grnet.gr/api/v2/handles/11239/?INST=GRNET</td>
    </tr>
    <tr>
      <td>URL</td>
      <td>string: the url you are searching for</td>
      <td>Search and get the PID of an object with the selected url</td>
      <td>https://epic.grnet.gr/api/v2/handles/11239/?URL=http://www.grnet.gr</td>
    </tr>
    <tr>
      <td>limit</td>
      <td>int: the limit of results</td>
      <td>Limit your results</td>
      <td>https://epic.grnet.gr/api/v2/handles/11239/?URL=http://www.grnet.gr&amp;limit=10</td>
    </tr>
  </tbody>
</table>

<h4 id="you-may-also">You may also:</h4>
<ul>
  <li>combine the parameters to get the list of PIDs. (e.g. https://epic.grnet.gr/api/v2/handles/11239/?URL=http://www.grnet.gr&amp;INST=GRNET).</li>
  <li>use part of the term in the search parameter (e.g. search for PIDS that contain “grnet” in the URL https://epic.grnet.gr/api/v2/handles/11239/?URL=*grnet*).</li>
</ul>

<h2 id="example">Example</h2>

<p>In this example we are going to use the term GRNET to retrieve the list of PIDs with the following URL https://epic.grnet.gr/api/v2/handles/11239/?URL=*GRNET*</p>



<ul class="nav nav-tabs">
	
	  
		  <li class="active"><a href="#tab-1" data-toggle="tab">Curl</a></li>
	  
	
	  
		  <li><a href="#tab-2" data-toggle="tab">Python</a></li>
	
	
	  
		  <li><a href="#tab-3" data-toggle="tab">PHP</a></li>
	
	
	  
		  <li><a href="#tab-4" data-toggle="tab">Perl</a></li>
	
	
</ul>
<div class="tab-content">
	
	 
	 <div class="tab-pane active" id="tab-1">
	  
		<p>The request in curl</p>

<pre><code>
curl -D- -u "YOURUSERNAME:YOURPASSWORD" -X GET -H "Content-Type: application/json" https://epic.grnet.gr/api/v2/handles/11239/?URL=*grnet*
</code></pre>

	 </div>
	
	 
	 <div class="tab-pane" id="tab-2">
	
		<p>The request in python</p>

<pre><code class="language-python"><span class="kn">import</span> <span class="nn">urllib2</span>

<span class="n">PIDSERVICE_URL</span><span class="o">=</span><span class="s">"THE_SERVICE_URL_WITH_PREFIX"</span>
<span class="n">PIDSERVICE_USER</span><span class="o">=</span><span class="s">"YOURUSERNAME"</span>
<span class="n">PIDSERVICE_PASSWD</span><span class="o">=</span><span class="s">"YOURPASSWORD"</span>
<span class="n">URL_TO_OPEN</span><span class="o">=</span><span class="n">PIDSERVICE_URL</span><span class="o">+</span><span class="s">"?URL=*grnet*"</span>
<span class="n">DATAURL</span><span class="o">=</span><span class="s">""</span>

<span class="c"># create a password manager</span>
<span class="n">password_mgr</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">HTTPPasswordMgrWithDefaultRealm</span><span class="p">()</span>

<span class="c"># Add the username and password.</span>
<span class="n">password_mgr</span><span class="o">.</span><span class="n">add_password</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">PIDSERVICE_URL</span><span class="p">,</span> <span class="n">PIDSERVICE_USER</span><span class="p">,</span> <span class="n">PIDSERVICE_PASSWD</span><span class="p">)</span>

<span class="n">handler</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">HTTPBasicAuthHandler</span><span class="p">(</span><span class="n">password_mgr</span><span class="p">)</span>

<span class="c"># create "opener" (OpenerDirector instance)</span>
<span class="n">opener</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">build_opener</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>

<span class="c"># use the opener to fetch a URL</span>
<span class="n">opener</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">PIDSERVICE_URL</span><span class="p">)</span>

<span class="c"># Install the opener.</span>
<span class="c"># Now all calls to urllib2.urlopen use the created opener.</span>
<span class="n">urllib2</span><span class="o">.</span><span class="n">install_opener</span><span class="p">(</span><span class="n">opener</span><span class="p">)</span>

<span class="n">REQUESTDATA</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">URL_TO_OPEN</span><span class="p">)</span>    
<span class="k">try</span><span class="p">:</span>
    <span class="n">DATAURL</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">REQUESTDATA</span><span class="p">)</span>
<span class="k">except</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">URLError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">"404-Not found"</span>
    <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">"401-Authentication failed"</span>    

<span class="k">if</span> <span class="n">DATAURL</span><span class="p">:</span>
    <span class="c"># Getting the code</span>
    <span class="k">print</span> <span class="s">"This gets the code: "</span><span class="p">,</span> <span class="n">DATAURL</span><span class="o">.</span><span class="n">code</span></code></pre>

	 </div>
	
	 
	 <div class="tab-pane" id="tab-3">
	
		<p>The request in php </p>

<pre><code class="language-php5"><span class="nv">$PIDSERVICE_URL</span><span class="o">=</span><span class="s2">"THE_SERVICE_URL_WITH_PREFIX"</span><span class="p">;</span>
<span class="nv">$PIDSERVICE_USER</span><span class="o">=</span><span class="s2">"YOURUSERNAME"</span><span class="p">;</span>
<span class="nv">$PIDSERVICE_PASSWD</span><span class="o">=</span><span class="s2">"YOURPASSWORD"</span><span class="p">;</span>
<span class="nv">$SEARCHTERM</span> <span class="o">=</span> <span class="s2">"grnet"</span><span class="p">;</span>
<span class="nv">$GETPIDURL</span> <span class="o">=</span><span class="nv">$PIDSERVICE_URL</span><span class="o">.</span><span class="s2">"?URL=*"</span><span class="o">.</span><span class="nv">$SEARCHTERM</span><span class="o">.</span><span class="s2">"*"</span><span class="p">;</span>

<span class="c1">// Get cURL resource</span>
<span class="nv">$curl</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
<span class="c1">// Set some options - we are passing in a useragent too here</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span><span class="nx">CURLOPT_URL</span><span class="p">,</span><span class="nv">$GETPIDURL</span><span class="p">);</span>
<span class="c1">// Set the authentication options</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_USERPWD</span><span class="p">,</span> <span class="nv">$PIDSERVICE_USER</span><span class="o">.</span><span class="s2">":"</span><span class="o">.</span><span class="nv">$PIDSERVICE_PASSWD</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPAUTH</span><span class="p">,</span> <span class="nx">CURLAUTH_BASIC</span><span class="p">);</span>

<span class="c1">// Include header in result? (0 = yes, 1 = no)</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="c1">// Should cURL return or print out the data? (true = return, false = print)</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>

<span class="c1">// Download the given URL, and return output</span>
<span class="nv">$output</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>

<span class="nv">$info</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="nv">$info</span><span class="p">[</span><span class="s1">'http_code'</span><span class="p">]</span><span class="o">==</span><span class="mi">200</span><span class="p">)</span> <span class="k">echo</span> <span class="s2">"PID DATA"</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span> <span class="nv">$info</span><span class="p">[</span><span class="s1">'http_code'</span><span class="p">]</span><span class="o">==</span><span class="mi">401</span><span class="p">)</span> <span class="k">echo</span> <span class="s2">"Authorization problem"</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span> <span class="nv">$info</span><span class="p">[</span><span class="s1">'http_code'</span><span class="p">]</span><span class="o">==</span><span class="mi">404</span><span class="p">)</span> <span class="k">echo</span> <span class="s2">"Not found"</span><span class="p">;</span>

<span class="c1">// Close the cURL resource, and free system resources</span>
<span class="nb">curl_close</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span></code></pre>

	 </div>
	
	 
	 <div class="tab-pane" id="tab-4">
	
		<p>The request in perl</p>

<pre><code class="language-perl"><span class="c1">#!/usr/bin/perl</span>

<span class="k">use</span> <span class="n">strict</span><span class="p">;</span>
<span class="k">use</span> <span class="n">warnings</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">Data::</span><span class="n">Dumper</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">Getopt::</span><span class="n">Long</span><span class="p">;</span>
<span class="k">use</span> <span class="n">Switch</span> <span class="s">'Perl5'</span><span class="p">,</span> <span class="s">'Perl6'</span><span class="p">;</span>
<span class="k">use</span> <span class="n">JSON</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">WWW::Curl::</span><span class="n">Easy</span><span class="p">;</span>

<span class="k">my</span> <span class="nv">$fullargv0</span> <span class="o">=</span> <span class="nv">$0</span><span class="p">;</span>
<span class="k">my</span> <span class="p">(</span><span class="nv">$argv0</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$fullargv0</span> <span class="o">=~</span><span class="sr"> /([^\/\\]+)$/</span><span class="p">;</span>

<span class="k">my</span> <span class="nv">%settings</span> <span class="o">=</span> <span class="p">(</span>
<span class="s">'debug'</span> <span class="o">=&gt;</span> <span class="s">'False'</span><span class="p">,</span>
<span class="s">'handle'</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="s">'action'</span> <span class="o">=&gt;</span><span class="s">'get'</span><span class="p">,</span>
	<span class="s">'credentials'</span> 	<span class="o">=&gt;</span>	<span class="p">{</span>
		<span class="s">'username'</span>	<span class="o">=&gt;</span> <span class="s">'empty'</span><span class="p">,</span>
		<span class="s">'password'</span>	<span class="o">=&gt;</span> <span class="s">'empty'</span><span class="p">,</span>
		<span class="s">'baseuri'</span>	<span class="o">=&gt;</span> <span class="s">'empty'</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="s">'data'</span>	<span class="o">=&gt;</span><span class="p">{</span>
		<span class="s">'get'</span>	<span class="o">=&gt;</span> <span class="s">''</span><span class="p">,</span>
		<span class="s">'putpost'</span><span class="o">=&gt;</span> <span class="s">''</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="s">'format'</span> <span class="o">=&gt;</span> <span class="s">'none'</span><span class="p">,</span>
	<span class="s">'headerextra'</span>	<span class="o">=&gt;</span> <span class="s">''</span><span class="p">,</span>
	<span class="s">'type'</span> <span class="o">=&gt;</span> <span class="s">'none'</span><span class="p">,</span>
	<span class="s">'url'</span><span class="o">=&gt;</span>	<span class="p">{</span>
		<span class="s">'pid'</span><span class="o">=&gt;</span> <span class="s">''</span><span class="p">,</span>
		<span class="s">'searchby'</span><span class="o">=&gt;</span> <span class="s">'url=*grnet*'</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">},</span>
<span class="p">);</span>

<span class="c1"># Main subroutine</span>
<span class="k">sub </span><span class="nf">main</span> <span class="p">{</span>

	<span class="c1">#Get the subroutine arguments</span>
	<span class="k">my</span> <span class="nv">$settings_ref</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>

	<span class="c1"># Get the script arguments</span>
	<span class="p">(</span><span class="k">my</span> <span class="nv">$returncode</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_arguments</span><span class="p">(</span><span class="nv">$settings_ref</span><span class="p">);</span>

	<span class="k">if</span><span class="p">(</span> <span class="nv">$returncode</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> 
		<span class="n">performGet</span><span class="p">(</span><span class="nv">$settings_ref</span><span class="p">);</span> 

	<span class="k">return</span><span class="p">(</span><span class="nv">$returncode</span><span class="p">);</span>
<span class="p">}</span>
 
<span class="c1"># Subroutine to perform a GET action</span>
<span class="k">sub </span><span class="nf">performGet</span> <span class="p">{</span>

	<span class="c1"># Get the subroutine arguments</span>
	<span class="k">my</span> <span class="nv">$settings_ref</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>

	<span class="c1">#construct url and headers</span>
	<span class="k">my</span> <span class="nv">$url</span><span class="o">=</span><span class="s">"$settings_ref-&gt;{handle}-&gt;{credentials}-&gt;{baseuri}$settings_ref-&gt;{handle}-&gt;{credentials}-&gt;{url}-&gt;{searchby}"</span><span class="p">;</span>
	<span class="nb">printf</span><span class="p">(</span><span class="s">"The constructed url is        : %s\n"</span><span class="p">,</span><span class="nv">$url</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
	<span class="k">my</span> <span class="nv">@httpHeaders</span> <span class="o">=</span> <span class="p">(</span><span class="s">'Accept: application/json'</span> <span class="p">)</span> <span class="p">;</span>
	<span class="nb">push</span><span class="p">(</span><span class="nv">@httpHeaders</span><span class="p">,</span> <span class="s">"$settings_ref-&gt;{handle}-&gt;{headerextra}"</span> <span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">headerextra</span><span class="p">}</span> <span class="p">;</span>

	<span class="c1"># perform action</span>
	<span class="p">(</span><span class="k">my</span> <span class="nv">$returncode</span><span class="p">,</span> <span class="k">my</span> <span class="nv">$response_code</span><span class="p">,</span> <span class="k">my</span> <span class="nv">$response_content_type</span> <span class="p">)</span> <span class="o">=</span> <span class="n">httpGet</span><span class="p">(</span><span class="nv">$settings_ref</span><span class="p">,</span> <span class="nv">$url</span><span class="p">,</span> <span class="o">\</span><span class="nv">@httpHeaders</span><span class="p">);</span>

	<span class="c1"># Looking at the results of the curl request</span>
	<span class="k">if</span> <span class="p">(</span><span class="nv">$returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">print</span><span class="p">(</span><span class="s">'Transfer went ok\n'</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

		<span class="c1"># judge result and next action based on $response_code</span>
		<span class="k">if</span> <span class="p">(</span><span class="nv">$response_code</span> <span class="o">&gt;=</span> <span class="mi">200</span> <span class="o">&amp;&amp;</span> <span class="nv">$response_code</span> <span class="o">&lt;</span> <span class="mi">300</span> <span class="p">)</span> <span class="p">{</span>
			<span class="k">print</span><span class="p">(</span><span class="s">'The request went ok\n'</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
			<span class="k">print</span> <span class="n">Dumper</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">data</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">get</span><span class="p">}</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

			<span class="c1"># show only types we want to show. implicit is that we than only show type and parsed_data</span>
			<span class="k">unless</span> <span class="p">(</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">type</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /none/</span> <span class="p">)</span> <span class="p">{</span>

				<span class="k">if</span> <span class="p">(</span><span class="nb">ref</span><span class="p">(</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">data</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">get</span><span class="p">})</span> <span class="ow">eq</span> <span class="s">'ARRAY'</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">print</span> <span class="s">"We have an array of hashes \n"</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

					<span class="c1"># grep so we have only the hashes with the selected fields</span>
					<span class="nv">@</span><span class="p">{</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">data</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">get</span><span class="p">}}</span> <span class="o">=</span> <span class="nb">grep</span> <span class="p">{</span><span class="nv">$_</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">type</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /$settings_ref-&gt;{handle}-&gt;{type}/</span> <span class="p">}</span> <span class="nv">@</span><span class="p">{</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">data</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">get</span><span class="p">}}</span> <span class="p">;</span> 
					<span class="k">print</span> <span class="n">Dumper</span> <span class="nv">@</span><span class="p">{</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">data</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">get</span><span class="p">}}</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

					<span class="c1"># delete items from retrieved handle which are not type and parsed_data</span>
					<span class="k">for</span> <span class="k">my</span> <span class="nv">$hash</span> <span class="p">(</span> <span class="nv">@</span><span class="p">{</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">data</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">get</span><span class="p">}})</span> <span class="p">{</span>
						<span class="k">foreach</span> <span class="k">my</span> <span class="nv">$key</span> <span class="p">(</span> <span class="nb">keys</span> <span class="nv">%$hash</span> <span class="p">)</span> <span class="p">{</span>			
							<span class="k">print</span> <span class="s">"key: $key, value: $hash-&gt;{$key}\n"</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
							<span class="k">unless</span> <span class="p">(</span> <span class="nv">$key</span> <span class="o">=~</span><span class="sr"> /^type|^parsed_data/</span> <span class="p">)</span> <span class="p">{</span>
								<span class="nb">delete</span> <span class="nv">$hash</span><span class="o">-&gt;</span><span class="p">{</span><span class="nv">$key</span><span class="p">};</span>
							<span class="p">}</span>
						<span class="p">}</span>	
					<span class="p">}</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="k">print</span> <span class="s">"We have a hash of arrays of hashes \n"</span> <span class="k">if</span>  <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
					<span class="c1"># grep so we have only the hashes with the selected fields</span>
					<span class="k">for</span> <span class="k">my</span> <span class="nv">$array</span> <span class="p">(</span><span class="nb">values</span><span class="p">(</span><span class="nv">%</span><span class="p">{</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">data</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">get</span><span class="p">}}))</span> <span class="p">{</span> 
						<span class="nv">@$array</span> <span class="o">=</span> <span class="nb">grep</span> <span class="p">{</span><span class="nv">$_</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">type</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /$settings_ref-&gt;{handle}-&gt;{type}/</span> <span class="p">}</span> <span class="nv">@$array</span> <span class="p">;</span>
					<span class="p">}</span> 
					<span class="k">print</span> <span class="n">Dumper</span> <span class="nv">%</span><span class="p">{</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">data</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">get</span><span class="p">}}</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

					<span class="c1"># delete items from retrieved handle which are not type and parsed_data</span>
					<span class="k">for</span> <span class="k">my</span> <span class="nv">$array</span> <span class="p">(</span><span class="nb">values</span><span class="p">(</span><span class="nv">%</span><span class="p">{</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">data</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">get</span><span class="p">}}))</span> <span class="p">{</span> 
						<span class="k">for</span> <span class="k">my</span> <span class="nv">$hash</span> <span class="p">(</span> <span class="nv">@$array</span> <span class="p">)</span> <span class="p">{</span>
							<span class="k">foreach</span> <span class="k">my</span> <span class="nv">$key</span> <span class="p">(</span> <span class="nb">keys</span> <span class="nv">%$hash</span> <span class="p">)</span> <span class="p">{</span>			
								<span class="k">print</span> <span class="s">"key: $key, value: $hash-&gt;{$key}\n"</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
								<span class="k">unless</span> <span class="p">(</span> <span class="nv">$key</span> <span class="o">=~</span><span class="sr"> /^type|^parsed_data/</span> <span class="p">)</span> <span class="p">{</span>
									<span class="nb">delete</span> <span class="nv">$hash</span><span class="o">-&gt;</span><span class="p">{</span><span class="nv">$key</span><span class="p">};</span>
								<span class="p">}</span>
							<span class="p">}</span>
						<span class="p">}</span>	
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>

			<span class="c1"># print the data in json format, pretty if the parameter is set</span>
			<span class="k">my</span> <span class="nv">$json</span> <span class="o">=</span> <span class="n">JSON</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">;</span>
			<span class="k">my</span> <span class="nv">$json_printed</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="nb">format</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /pretty/</span> <span class="p">)</span> <span class="p">{</span>
				<span class="nv">$json_printed</span> <span class="o">=</span> <span class="nv">$json</span><span class="o">-&gt;</span><span class="n">pretty</span><span class="o">-&gt;</span><span class="n">encode</span><span class="p">(</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">data</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">get</span><span class="p">}</span> <span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="nv">$json_printed</span> <span class="o">=</span> <span class="nv">$json</span><span class="o">-&gt;</span><span class="n">encode</span><span class="p">(</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">data</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">get</span><span class="p">}</span> <span class="p">);</span>
			<span class="p">}</span>
			<span class="k">print</span><span class="p">(</span><span class="s">"$json_printed\n"</span><span class="p">);</span>

		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="k">print</span><span class="p">(</span><span class="s">'The request went NOT ok\n'</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
			<span class="k">print</span><span class="p">(</span><span class="s">"$response_code\n"</span><span class="p">);</span>
		<span class="p">}</span> 

	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">print</span><span class="p">(</span><span class="s">'An error happened\n'</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Subroutine to retrieve data via a http GET</span>
<span class="k">sub </span><span class="nf">httpGet</span> <span class="p">{</span>

	<span class="c1"># Get the subroutine arguments</span>
	<span class="k">my</span> <span class="nv">$settings_ref</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$httpHeaders_ref</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>

	<span class="k">print</span><span class="p">(</span><span class="s">'Entering httpGet              :\n'</span><span class="p">)</span>         <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span><span class="p">;</span>

	<span class="c1"># local varables</span>
	<span class="k">my</span> <span class="nv">$response_body</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$response_code</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$response_content_type</span><span class="p">;</span>

	<span class="k">my</span> <span class="nv">$curl</span> <span class="o">=</span> <span class="nn">WWW::Curl::</span><span class="n">Easy</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">;</span>

	<span class="c1"># set options for the curl http request</span>
	<span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">setopt</span><span class="p">(</span><span class="n">CURLOPT_HEADER</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">setopt</span><span class="p">(</span><span class="n">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="nv">$httpHeaders_ref</span> <span class="p">);</span>
	<span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">setopt</span><span class="p">(</span><span class="n">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
	<span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">setopt</span><span class="p">(</span><span class="n">CURLOPT_USERNAME</span><span class="p">,</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">username</span><span class="p">});</span>
	<span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">setopt</span><span class="p">(</span><span class="n">CURLOPT_PASSWORD</span><span class="p">,</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">password</span><span class="p">});</span>

	<span class="c1"># A filehandle, reference to a scalar or reference to a typeglob can be used here.</span>
	<span class="nb">open</span> <span class="k">my</span> <span class="nv">$fh</span><span class="p">,</span> <span class="s">'&gt;'</span><span class="p">,</span> <span class="o">\</span><span class="nv">$response_body</span> <span class="ow">or</span> <span class="nb">die</span> <span class="s">"$!"</span><span class="p">;</span>
	<span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">setopt</span><span class="p">(</span><span class="n">CURLOPT_WRITEDATA</span><span class="p">,</span> <span class="nv">$fh</span><span class="p">);</span>

	<span class="c1"># Do the actual curl http request</span>
	<span class="k">my</span> <span class="nv">$returncode</span> <span class="o">=</span> <span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">perform</span><span class="p">;</span>

	<span class="c1"># close file handle</span>
	<span class="nb">close</span><span class="p">(</span><span class="nv">$fh</span><span class="p">);</span>

	<span class="c1"># Looking at the results of the curl request</span>
	<span class="k">if</span> <span class="p">(</span><span class="nv">$returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">print</span><span class="p">(</span><span class="s">'Transfer went ok\n'</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

		<span class="nv">$response_code</span>         <span class="o">=</span> <span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">getinfo</span><span class="p">(</span><span class="n">CURLINFO_HTTP_CODE</span><span class="p">);</span>
		<span class="nv">$response_content_type</span> <span class="o">=</span> <span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">getinfo</span><span class="p">(</span><span class="n">CURLINFO_CONTENT_TYPE</span><span class="p">);</span>
		<span class="k">print</span><span class="p">(</span><span class="s">"Received response code        : $response_code\n"</span><span class="p">)</span>         <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span><span class="p">;</span>
		<span class="k">print</span><span class="p">(</span><span class="s">"Received response content type: $response_content_type\n"</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span><span class="p">;</span>

		<span class="c1"># judge result and next action based on $response_code</span>
		<span class="k">if</span> <span class="p">(</span><span class="nv">$response_code</span> <span class="o">&gt;=</span> <span class="mi">200</span> <span class="o">&amp;&amp;</span> <span class="nv">$response_code</span> <span class="o">&lt;</span> <span class="mi">300</span> <span class="p">)</span> <span class="p">{</span>
			<span class="k">print</span><span class="p">(</span><span class="s">'The request went ok\n'</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
			<span class="k">print</span><span class="p">(</span><span class="s">"$response_body\n"</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span><span class="p">;</span>

			<span class="c1"># convert from json and put in correct place </span>
			<span class="k">my</span> <span class="nv">$json</span> <span class="o">=</span> <span class="n">JSON</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">;</span>
			<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">data</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">get</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$json</span><span class="o">-&gt;</span><span class="n">decode</span><span class="p">(</span><span class="nv">$response_body</span><span class="p">);</span>

		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="k">print</span><span class="p">(</span><span class="s">'The request went NOT ok\n'</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
			<span class="k">print</span><span class="p">(</span><span class="s">"$response_code\n"</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span><span class="p">;</span>
		<span class="p">}</span> 

	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="c1"># Error code, type of error, error message</span>
		<span class="k">print</span><span class="p">(</span><span class="s">"An error happened: $returncode "</span><span class="o">.</span><span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">strerror</span><span class="p">(</span><span class="nv">$returncode</span><span class="p">)</span><span class="o">.</span><span class="s">" "</span><span class="o">.</span><span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">errbuf</span><span class="o">.</span><span class="s">"\n"</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="c1"># Return the results</span>
	<span class="k">return</span><span class="p">(</span><span class="nv">$returncode</span><span class="p">,</span> <span class="nv">$response_code</span><span class="p">,</span> <span class="nv">$response_content_type</span> <span class="p">);</span>
<span class="p">}</span>

<span class="c1"># Subroutine to get and check all script arguments</span>
<span class="k">sub </span><span class="nf">get_arguments</span> <span class="p">{</span>

	<span class="c1"># Get the subroutine arguments</span>
	<span class="k">my</span> <span class="nv">$settings_ref</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>

	<span class="c1"># Define local variables</span>
	<span class="k">my</span> <span class="nv">%arguments</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$username</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$password</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$baseUri</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$pidUrl</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$credentials</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$handleData</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$type</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$header</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$returncode</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$message</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">@sources</span><span class="p">;</span>

	<span class="n">GetOptions</span><span class="p">(</span> <span class="s">'h|help'</span>    <span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$arguments</span><span class="p">{</span><span class="n">help</span><span class="p">},</span>
		<span class="s">'user=s'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$username</span><span class="p">,</span>
		<span class="s">'passwd=s'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$password</span><span class="p">,</span>
		<span class="s">'base=s'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$baseUri</span><span class="p">,</span>
		<span class="s">'pid=s'</span>			<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$pidUrl</span><span class="p">,</span>
		<span class="s">'cred=s'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$credentials</span><span class="p">,</span>
		<span class="s">'data=s'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$handleData</span><span class="p">,</span>
		<span class="s">'type=s'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$type</span><span class="p">,</span>
		<span class="s">'header=s'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$header</span><span class="p">,</span>
		<span class="s">'get'</span>			<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$arguments</span><span class="p">{</span><span class="n">get</span><span class="p">},</span>
		<span class="s">'put'</span>			<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$arguments</span><span class="p">{</span><span class="n">put</span><span class="p">},</span>
		<span class="s">'delete'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$arguments</span><span class="p">{</span><span class="nb">delete</span><span class="p">},</span>
		<span class="s">'post'</span>			<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$arguments</span><span class="p">{</span><span class="n">post</span><span class="p">},</span>
		<span class="s">'pretty'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$arguments</span><span class="p">{</span><span class="n">pretty</span><span class="p">},</span>
		<span class="s">'d|debug'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$arguments</span><span class="p">{</span><span class="n">debug</span><span class="p">},</span>
	<span class="p">);</span>

	<span class="c1"># Check the help flag</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$arguments</span><span class="p">{</span><span class="n">help</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

		<span class="c1"># Set the returncode</span>
		<span class="nv">$returncode</span><span class="o">=</span><span class="mi">255</span><span class="p">;</span>

		<span class="nv">$message</span> <span class="o">=</span> <span class="n">print_help</span><span class="p">();</span>
	<span class="p">}</span>
	
	<span class="c1"># Check the debug flag</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$arguments</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=</span> <span class="s">'True'</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">'debug is                      : on\n'</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span>

	<span class="c1"># Check the pretty flag</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$arguments</span><span class="p">{</span><span class="n">pretty</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="nb">format</span><span class="p">}</span> <span class="o">=</span> <span class="s">'pretty'</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">'pretty format printing is     : on\n'</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span>

	<span class="c1"># Check the action flag's (get,put,delete,post,search,nagios)</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$arguments</span><span class="p">{</span><span class="n">get</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">action</span><span class="p">}</span> <span class="o">=</span> <span class="s">'get'</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The action is                 : %s\n"</span><span class="p">,</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">action</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span> <span class="k">elsif</span> <span class="p">(</span> <span class="nv">$arguments</span><span class="p">{</span><span class="n">put</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">action</span><span class="p">}</span> <span class="o">=</span> <span class="s">'put'</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The action is                 : %s\n"</span><span class="p">,</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">action</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span> <span class="k">elsif</span> <span class="p">(</span> <span class="nv">$arguments</span><span class="p">{</span><span class="nb">delete</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">action</span><span class="p">}</span> <span class="o">=</span> <span class="s">'delete'</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The action is                 : %s\n"</span><span class="p">,</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">action</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span> <span class="k">elsif</span> <span class="p">(</span> <span class="nv">$arguments</span><span class="p">{</span><span class="n">post</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">action</span><span class="p">}</span> <span class="o">=</span> <span class="s">'post'</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The action is                 : %s\n"</span><span class="p">,</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">action</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span>

	<span class="c1"># check the username</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$username</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">username</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$username</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The username is               : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">username</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span>

	<span class="c1"># check the password</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$password</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">password</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$password</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The password is               : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">password</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span>

	<span class="c1"># check the base uri</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$baseUri</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">baseuri</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$baseUri</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The base uri is               : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">baseuri</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span>

	<span class="c1"># check the pid url</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$pidUrl</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">url</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">pid</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$pidUrl</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The pid is                    : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">url</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">pid</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
	
	<span class="p">}</span>

	<span class="c1"># check the handle data</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$handleData</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">data</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">putpost</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$handleData</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The data is                   : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">data</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">putpost</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
	
	<span class="p">}</span>

	<span class="c1"># check the type data</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$type</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">type</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$type</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The type(s) to show is/are    : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">type</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span>
	
	<span class="c1"># check the header data</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$header</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">headerextra</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$header</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The extra header info is      : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">headerextra</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
	
	<span class="p">}</span>

	<span class="c1"># check the credentials data</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$credentials</span> <span class="p">)</span> <span class="p">{</span>

		<span class="c1"># read the credentials from the file</span>
		<span class="k">my</span> <span class="nv">$filename</span> <span class="o">=</span> <span class="nv">$credentials</span><span class="p">;</span>
		<span class="k">my</span> <span class="nv">$json_text</span> <span class="o">=</span> <span class="k">do</span> <span class="p">{</span>
			<span class="nb">open</span><span class="p">(</span><span class="k">my</span> <span class="nv">$json_fh</span><span class="p">,</span> <span class="s">"&lt;:encoding(UTF-8)"</span><span class="p">,</span> <span class="nv">$filename</span><span class="p">)</span>  <span class="ow">or</span> <span class="nb">die</span><span class="p">(</span><span class="s">"Can't open $filename: $!\n"</span><span class="p">);</span>
			<span class="nb">local</span> <span class="vg">$/</span><span class="p">;</span>
			<span class="sr">&lt;$json_fh&gt;</span>
		<span class="p">};</span>

		<span class="c1"># convert from json and put in correct place </span>
		<span class="k">my</span> <span class="nv">$json</span> <span class="o">=</span> <span class="n">JSON</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">;</span>
		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$json</span><span class="o">-&gt;</span><span class="n">decode</span><span class="p">(</span><span class="nv">$json_text</span><span class="p">);</span>

		<span class="nb">printf</span><span class="p">(</span><span class="s">"The username is               : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">username</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The password is               : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">password</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The base uri is               : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">baseuri</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
	<span class="p">}</span>

	<span class="c1"># Print the message</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$message</span> <span class="p">)</span> <span class="p">{</span>

		<span class="k">print</span> <span class="s">"$message\n"</span><span class="p">;</span>
	<span class="p">};</span>

	<span class="c1"># Return the results</span>
	<span class="k">return</span><span class="p">(</span><span class="nv">$returncode</span><span class="p">);</span>

<span class="p">};</span></code></pre>

	 </div>
	
</div>
	
		
			<h3 id="the-response">The response:</h3>

<ul>
  <li>HTTP/1.1 200 OK: (Success)</li>
  <li>HTTP/1.1 401 Unauthorized: Your username or your password is wrong</li>
  <li>HTTP/1.1 404 NOT found: The url doesn’t exist</li>
</ul>

<p>After a successful request, the response consists of a list of PIDs containing this term.</p>

<pre><code>
GRNET
66742AB2-5685-11E3-A413-1C6F65A666B5
305F66A9-3994-42D6-A9F6-8E629126DE14
B4CF7AEA-55BB-4DB5-9D85-EB2DAD821B07
0CEEA495-71FA-460B-97A4-81E7E597B636
</code></pre>

		
	

 <!--end item[:slug]-->
 </div>


    <div id="js-sidebar" class="sidebar-shell">
      <div class="sidebar-module">
        <ul>
          <li><h3><a href="/guides/overview">Overview</a></h3></li>
          <li><h3><a href="/guides/glossary/">Glossary</a></h3></li>
          <li><h3><a href="#">API</a></h3></li>
          <li><ul>
                <li><h3><a href="/guides/api/">Getting Started</a></h3></li>
                <li><h3><a href="/guides/api-auth/">Authenticate</a></h3></li>
                <li><h3><a href="/guides/api-generation/">PID Generation</a></h3></li>
                <li><h3><a href="/guides/api-get/">Get a PID</a></h3></li>
                <li><h3><a href="/guides/api-list/">List all PID</a></h3></li>
                <li><h3><a href="/guides/api-search/">Search</a></h3></li>
                <li><h3><a href="/guides/api-create/">Create a PID</a></h3></li>
                <li><h3><a href="/guides/api-update/">Update a PID</a></h3></li>
                <li><h3><a href="/guides/api-delete/">Delete a PID</a></h3></li>
                <li><h3><a href="/guides/api-partial/">Part Identifiers</a></h3></li>
          </ul></li>
        </ul> 
      </div>
      <div class="sidebar-module notice padding10">
          <strong>Service Url:</strong>
          <span class="txtcenter"> https://epic.grnet.gr/api/v2/handles/ </span>
      </div><!--sidebar-module-->
	</div>
  </div><!-- #wrapper -->

  	<div id="footer" >
    <div class="lower_footer">
      <ul class="footer-cell">
	
      </ul>

      <span class="footer-cell">
        <a href="http://www.grnet.gr"><img src="/shared/images/grnet-logo.jpg" alt='GRNET'/></a>
      </span>

      <ul class="footer-cell">
	
      </ul>
    </div>

  </div><!-- /#footer -->

</body>
</html>


