<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>API | PID generation</title>
  <link rel="alternate" type="application/atom+xml" title="API Changes" href="/changes.atom" />
  <link href="/css/reset.css" rel="stylesheet" type="text/css" />
  <link href="/css/960.css" rel="stylesheet" type="text/css" />
  <link href="/css/uv_active4d.css" rel="stylesheet" type="text/css" />
  <link href="/shared/css/documentation.css" media="screen" rel="stylesheet" type="text/css">
  <link href="/shared/css/pygments.css" media="screen" rel="stylesheet" type="text/css">
  <script src="/shared/js/jquery.js" type="text/javascript"></script>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans+Condensed:700,300,300italic' rel='stylesheet' type='text/css'>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
<!-- Optional theme -->
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
<!-- Latest compiled and minified JavaScript -->
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

<script>
  $(function () {
    $('#myTab a:last').tab('show')
  })
</script>


<body class="api">
  <nav role="navigation" class="navbar navbar-default">
  <div class="container">
    <div class="navbar-header">
      <button data-target=".bs-navbar-collapse" data-toggle="collapse" type="button" class="navbar-toggle">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Epic Api</a>
    </div>
    <nav role="navigation" class="collapse navbar-collapse bs-navbar-collapse">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="/guides/overview" class="nav-overview"><span class="glyphicon glyphicon-list-alt"></span> Overview</a></li>
        <li><a href="/guides/api/" class="nav-api"><span class="glyphicon glyphicon-wrench"></span> API</a></li>
        <li><a href="/guides/glossary/" class="nav-blog"><span class="glyphicon glyphicon-sort-by-alphabet"></span> Glossary</a></li>
      </ul>
    </nav>
  </div>
</nav>
<!--<div id="header-wrapper">
-->
<!--  <div id="header">
    <div>
      <a class="logo" href="/">GRNET PID Service</a>
      <ul class="nav">
        <li><a href="/guides/overview" class="nav-overview">Overview</a></li>
        <li><a href="/guides/api/" class="nav-api">API</a></li>
        <li><a href="/guides/glossary/" class="nav-blog">Glossary</a></li>
      </ul>
    </div>
    </div>
    </div>
-->


  <div id="wrapper">
    <div class="content">
      <h1 id="api---pid-generation">API - PID generation</h1>

<p>Every identifier consists of two parts: its prefix , and a unique local name under the prefix known as its suffix</p>

<p><span class="txtcenter"><strong>
&lt; PREFIX &gt; / &lt; SUFFIX &gt; (e.g. 11239/123456745).
</strong></span></p>

<p>Any suffix - local name must be unique under its local namespace. The uniqueness of a prefix and a local name under that prefix ensures that any identifier is globally unique within the context of the System.</p>

<p>There are two ways to generate the SUFFIX a) automatic and b) manual</p>

<h2 id="automatic-generation-of-suffix">Automatic generation of SUFFIX</h2>

<p>The API supports the automatic generation of a local name - suffix by using a generator via a POST Request. This generator uses UUIDs to guarantee the uniqueness of created handles. The syntax follows the following pattern</p>

<p><span class="txtcenter"><strong>SUFFIX = prefix - UUID - suffix </strong></span></p>

<p><strong><em>where</em></strong></p>

<ul>
  <li>
<strong>prefix</strong>: Optional: a string of UTF-8 encoded printable unicode characters to put before the UUID.</li>
  <li>
<strong>UUID</strong>: UUID stands for Universally Unique IDentifier, GUID for Globally Unique IDentifier. A universally unique identifier (UUID) is an identifier standard used in software construction, standardized by the Open Software Foundation (OSF) as part of the Distributed Computing Environment (DCE). The intent of UUIDs is to enable distributed systems to uniquely identify information without significant central coordination.</li>
  <li>
<strong>suffix</strong>: Optional: a string of UTF-8 encoded printable unicode characters to put after the UUID.</li>
</ul>

<h2 id="example">Example</h2>

<p>In this example we are going to use the automatic creation of PID. The automatic generation of PID is executed using a POST HTTP Request.</p>



<ul class="nav nav-tabs">
	
	  
		  <li class="active"><a href="#tab-1" data-toggle="tab">Curl</a></li>
	  
	
	  
		  <li><a href="#tab-2" data-toggle="tab">Python</a></li>
	
	
	  
		  <li><a href="#tab-3" data-toggle="tab">PHP</a></li>
	
	
	  
		  <li><a href="#tab-4" data-toggle="tab">Perl</a></li>
	
	
</ul>
<div class="tab-content">
	
	 
	 <div class="tab-pane active" id="tab-1">
	  
		<p>The request in curl</p>

<pre><code>
curl -v -u "YOURUSERNAME:YOURPASSWORD" -H "Accept:application/json" -H "Content-Type:application/json" -X POST --data '[{"type":"URL","parsed_data":"http://www.grnet.gr/"}]' https://epic.grnet.gr/api/v2/handles/11239/\?prefix=GRNET\&amp;suffix=TEST

</code></pre>

	 </div>
	
	 
	 <div class="tab-pane" id="tab-2">
	
		<p>The request in python. 
The main difference is that you have to do a POST request.</p>

<pre><code class="language-python"><span class="kn">import</span> <span class="nn">urllib2</span>
<span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">PIDSERVICE_URL</span><span class="o">=</span><span class="s">"THE_SERVICE_URL_WITH_PREFIX"</span>
<span class="n">PIDSERVICE_USER</span><span class="o">=</span><span class="s">"YOURUSERNAME"</span>
<span class="n">PIDSERVICE_PASSWD</span><span class="o">=</span><span class="s">"YOURPASSWORD"</span>
<span class="n">SUFFIX</span> <span class="o">=</span><span class="s">"?prefix=GRNET&amp;suffix=test"</span>
<span class="n">URL_TO_OPEN</span><span class="o">=</span><span class="n">PIDSERVICE_URL</span><span class="o">+</span><span class="n">SUFFIX</span>
<span class="n">DATAURL</span><span class="o">=</span><span class="s">''</span>

<span class="c"># create a password manager</span>
<span class="n">password_mgr</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">HTTPPasswordMgrWithDefaultRealm</span><span class="p">()</span>

<span class="c"># Add the username and password.</span>
<span class="n">password_mgr</span><span class="o">.</span><span class="n">add_password</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">PIDSERVICE_URL</span><span class="p">,</span> <span class="n">PIDSERVICE_USER</span><span class="p">,</span> <span class="n">PIDSERVICE_PASSWD</span><span class="p">)</span>

<span class="n">handler</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">HTTPBasicAuthHandler</span><span class="p">(</span><span class="n">password_mgr</span><span class="p">)</span>

<span class="c"># create "opener" (OpenerDirector instance)</span>
<span class="n">opener</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">build_opener</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>

<span class="c"># use the opener to fetch a URL</span>
<span class="n">opener</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">PIDSERVICE_URL</span><span class="p">)</span>

<span class="c"># Install the opener.</span>
<span class="c"># Now all calls to urllib2.urlopen use the created opener.</span>
<span class="n">urllib2</span><span class="o">.</span><span class="n">install_opener</span><span class="p">(</span><span class="n">opener</span><span class="p">)</span>

<span class="c">#create the json data</span>
<span class="n">JSONDATA</span> <span class="o">=</span> <span class="p">[{</span><span class="s">'type'</span><span class="p">:</span><span class="s">'URL'</span><span class="p">,</span><span class="s">'parsed_data'</span><span class="p">:</span><span class="s">'http://www.grnet.gr'</span><span class="p">}]</span>
<span class="n">JSONDATATOSEND</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">JSONDATA</span><span class="p">);</span>

<span class="n">REQUESTDATA</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">URL_TO_OPEN</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">JSONDATATOSEND</span><span class="p">)</span>

<span class="c">#create the headers</span>
<span class="n">REQUESTDATA</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">'Content-Type'</span><span class="p">,</span><span class="s">'application/json'</span><span class="p">)</span>
<span class="n">REQUESTDATA</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">'Content-Length'</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">JSONDATATOSEND</span><span class="p">))</span>

<span class="c"># creates the POST method</span>
<span class="n">REQUESTDATA</span><span class="o">.</span><span class="n">get_method</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="s">'POST'</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">DATAURL</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">REQUESTDATA</span><span class="p">)</span>
    
<span class="k">except</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">URLError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">e</span>
    <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">"404-Not found"</span>
    <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">"401-Authentication failed"</span>    
        <span class="c">#get http code of the request</span>

<span class="k">if</span> <span class="n">DATAURL</span><span class="p">:</span>
    <span class="c"># Getting the code</span>
    <span class="k">print</span> <span class="s">"This gets the code: "</span><span class="p">,</span> <span class="n">DATAURL</span><span class="o">.</span><span class="n">code</span></code></pre>

	 </div>
	
	 
	 <div class="tab-pane" id="tab-3">
	
		<p>The request in php </p>

<pre><code class="language-php5"><span class="nv">$PIDSERVICE_URL</span><span class="o">=</span><span class="s2">"THE_SERVICE_URL_WITH_PREFIX"</span><span class="p">;</span>
<span class="nv">$PIDSERVICE_USER</span><span class="o">=</span><span class="s2">"YOURUSERNAME"</span><span class="p">;</span>
<span class="nv">$PIDSERVICE_PASSWD</span><span class="o">=</span><span class="s2">"YOURPASSWORD"</span><span class="p">;</span>
<span class="nv">$UUID</span> <span class="o">=</span> <span class="s2">"?prefix=GRNET&amp;suffix=TEST"</span><span class="p">;</span>
<span class="nv">$URL_TO_OPEN</span> <span class="o">=</span> <span class="nv">$PIDSERVICE_URL</span><span class="o">.</span><span class="nv">$UUID</span><span class="p">;</span>
<span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">'type'</span> <span class="o">=&gt;</span> <span class="s1">'URL'</span><span class="p">,</span><span class="s1">'parsed_data'</span><span class="o">=&gt;</span><span class="s1">'http://www.grnet.gr/'</span><span class="p">));</span>
<span class="nv">$update_json</span><span class="o">=</span><span class="nb">json_encode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>

<span class="c1">// Get cURL resource</span>
<span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>

<span class="c1">//Set the headers to complete the request</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'Content-Type: application/json'</span><span class="p">,</span><span class="s1">'Content-Length: '</span> <span class="o">.</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$update_json</span><span class="p">)));</span>

<span class="c1">//set the POST Action</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">"POST"</span><span class="p">);</span>

<span class="c1">//SET the postfield data</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span><span class="nv">$update_json</span><span class="p">);</span>

<span class="c1">// Should cURL return or print out the data? (true = return, false = print)</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>

<span class="c1">//Set the url with the new name of the PID </span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$URL_TO_OPEN</span><span class="p">);</span>

<span class="c1">// Set the authentication options</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_USERPWD</span><span class="p">,</span> <span class="nv">$PIDSERVICE_USER</span><span class="o">.</span><span class="s2">":"</span><span class="o">.</span><span class="nv">$PIDSERVICE_PASSWD</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPAUTH</span><span class="p">,</span> <span class="nx">CURLAUTH_BASIC</span><span class="p">);</span>

<span class="nv">$output</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="nv">$info</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

<span class="c1">// Download the given URL, and return output </span>

<span class="k">if</span><span class="p">(</span> <span class="nv">$info</span><span class="p">[</span><span class="s1">'http_code'</span><span class="p">]</span><span class="o">==</span><span class="mi">200</span><span class="p">)</span> <span class="k">echo</span> <span class="s2">"HANDLE EXISTS"</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span> <span class="nv">$info</span><span class="p">[</span><span class="s1">'http_code'</span><span class="p">]</span><span class="o">==</span><span class="mi">201</span><span class="p">)</span> <span class="k">echo</span> <span class="s2">"PID CREATED"</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span> <span class="nv">$info</span><span class="p">[</span><span class="s1">'http_code'</span><span class="p">]</span><span class="o">==</span><span class="mi">204</span><span class="p">)</span> <span class="k">echo</span> <span class="s2">"PID UPDATED"</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span> <span class="nv">$info</span><span class="p">[</span><span class="s1">'http_code'</span><span class="p">]</span><span class="o">==</span><span class="mi">404</span><span class="p">)</span> <span class="k">echo</span> <span class="s2">"HANDLE DOESNT EXIST"</span><span class="p">;</span>

<span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span></code></pre>

	 </div>
	
	 
	 <div class="tab-pane" id="tab-4">
	
		<p>The request in perl</p>

<pre><code class="language-perl"><span class="c1">#!/usr/bin/perl</span>

<span class="k">use</span> <span class="n">strict</span><span class="p">;</span>
<span class="k">use</span> <span class="n">warnings</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">Data::</span><span class="n">Dumper</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">Getopt::</span><span class="n">Long</span><span class="p">;</span>
<span class="k">use</span> <span class="n">Switch</span> <span class="s">'Perl5'</span><span class="p">,</span> <span class="s">'Perl6'</span><span class="p">;</span>
<span class="k">use</span> <span class="n">JSON</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">WWW::Curl::</span><span class="n">Easy</span><span class="p">;</span>

<span class="k">my</span> <span class="nv">$fullargv0</span> <span class="o">=</span> <span class="nv">$0</span><span class="p">;</span>
<span class="k">my</span> <span class="p">(</span><span class="nv">$argv0</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$fullargv0</span> <span class="o">=~</span><span class="sr"> /([^\/\\]+)$/</span><span class="p">;</span>

<span class="k">my</span> <span class="nv">%settings</span> <span class="o">=</span> <span class="p">(</span>
<span class="s">'debug'</span> <span class="o">=&gt;</span> <span class="s">'False'</span><span class="p">,</span>
<span class="s">'handle'</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="s">'action'</span> <span class="o">=&gt;</span><span class="s">'put'</span><span class="p">,</span>
	<span class="s">'credentials'</span> 	<span class="o">=&gt;</span>	<span class="p">{</span>
		<span class="s">'username'</span>	<span class="o">=&gt;</span> <span class="s">'empty'</span><span class="p">,</span>
		<span class="s">'password'</span>	<span class="o">=&gt;</span> <span class="s">'empty'</span><span class="p">,</span>
		<span class="s">'baseuri'</span>	<span class="o">=&gt;</span> <span class="s">'empty'</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="s">'data'</span>	<span class="o">=&gt;</span><span class="p">{</span>
		<span class="s">'get'</span>	<span class="o">=&gt;</span> <span class="s">''</span><span class="p">,</span>
		<span class="s">'putpost'</span><span class="o">=&gt;</span> <span class="s">''</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="s">'format'</span> <span class="o">=&gt;</span> <span class="s">'none'</span><span class="p">,</span>
	<span class="s">'headerextra'</span>	<span class="o">=&gt;</span> <span class="s">''</span><span class="p">,</span>
	<span class="s">'type'</span> <span class="o">=&gt;</span> <span class="s">'none'</span><span class="p">,</span>
	<span class="s">'url'</span><span class="o">=&gt;</span>	<span class="p">{</span>
		<span class="s">'pid'</span><span class="o">=&gt;</span> <span class="s">'prefix=GRNET&amp;suffix=TEST'</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">},</span>
<span class="p">);</span>

<span class="c1"># Main subroutine</span>
<span class="k">sub </span><span class="nf">main</span> <span class="p">{</span>

	<span class="c1">#Get the subroutine arguments</span>
	<span class="k">my</span> <span class="nv">$settings_ref</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>

	<span class="c1"># Get the script arguments</span>
	<span class="p">(</span><span class="k">my</span> <span class="nv">$returncode</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_arguments</span><span class="p">(</span><span class="nv">$settings_ref</span><span class="p">);</span>

	<span class="k">if</span><span class="p">(</span> <span class="nv">$returncode</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> 
	 <span class="n">performPost</span><span class="p">(</span><span class="nv">$settings_ref</span><span class="p">);</span>

	<span class="k">return</span><span class="p">(</span><span class="nv">$returncode</span><span class="p">);</span>
<span class="p">}</span>
 
<span class="c1"># Subroutine to perform a POST action</span>
<span class="k">sub </span><span class="nf">performPost</span> <span class="p">{</span>

	<span class="c1"># Get the subroutine arguments</span>
	<span class="k">my</span> <span class="nv">$settings_ref</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>

	<span class="c1">#construct url and headers</span>
	<span class="k">my</span> <span class="nv">$url</span><span class="o">=</span><span class="s">"$settings_ref-&gt;{handle}-&gt;{credentials}-&gt;{baseuri}$settings_ref-&gt;{handle}-&gt;{url}-&gt;{pid}"</span><span class="p">;</span>
	<span class="nb">printf</span><span class="p">(</span><span class="s">"The constructed url is        : %s\n"</span><span class="p">,</span><span class="nv">$url</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
	<span class="k">my</span> <span class="nv">@httpHeaders</span> <span class="o">=</span> <span class="p">(</span> <span class="s">'Content-Type: application/json'</span> <span class="p">);</span>

	<span class="c1">#construct data</span>
	<span class="k">my</span> <span class="nv">$data</span><span class="o">=</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">data</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">putpost</span><span class="p">};</span>
	<span class="nb">printf</span><span class="p">(</span><span class="s">"The data is                   : %s\n"</span><span class="p">,</span><span class="nv">$data</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="c1"># perform action</span>
	<span class="p">(</span><span class="k">my</span> <span class="nv">$returncode</span><span class="p">,</span> <span class="k">my</span> <span class="nv">$response_code</span><span class="p">,</span> <span class="k">my</span> <span class="nv">$response_content_type</span><span class="p">,</span> <span class="k">my</span> <span class="nv">$response_url</span> <span class="p">)</span> <span class="o">=</span> <span class="n">httpPost</span><span class="p">(</span><span class="nv">$settings_ref</span><span class="p">,</span> <span class="nv">$url</span><span class="p">,</span> <span class="o">\</span><span class="nv">@httpHeaders</span><span class="p">,</span> <span class="nv">$data</span> <span class="p">);</span>

	<span class="c1"># Looking at the results of the curl request</span>
	<span class="k">if</span> <span class="p">(</span><span class="nv">$returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">print</span><span class="p">(</span><span class="s">'Transfer went ok\n'</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

		<span class="c1"># judge result and next action based on $response_code</span>
		<span class="k">if</span> <span class="p">(</span><span class="nv">$response_code</span> <span class="o">&gt;=</span> <span class="mi">200</span> <span class="o">&amp;&amp;</span> <span class="nv">$response_code</span> <span class="o">&lt;</span> <span class="mi">300</span> <span class="p">)</span> <span class="p">{</span>
			<span class="k">print</span><span class="p">(</span><span class="s">'The request went ok\n'</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
			<span class="k">print</span><span class="p">(</span><span class="s">"$response_url\n"</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="k">print</span><span class="p">(</span><span class="s">'The request went NOT ok\n'</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
			<span class="k">print</span><span class="p">(</span><span class="s">"$response_code\n"</span><span class="p">);</span>
		<span class="p">}</span> 

	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">print</span><span class="p">(</span><span class="s">'An error happened\n'</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="c1"># reader helper calback function</span>
<span class="k">sub </span><span class="nf">read_callback</span> <span class="p">{</span>
	<span class="k">my</span> <span class="p">(</span><span class="nv">$maxlength</span><span class="p">,</span><span class="nv">$pointer</span><span class="p">)</span><span class="o">=</span><span class="nv">@_</span><span class="p">;</span>
	<span class="c1"># printf("The MAXLENGTH is     : \n", $maxlength);</span>
	<span class="c1"># printf("The POINTER is       : \n", $$pointer) ;</span>
	<span class="k">my</span> <span class="nv">$data</span> <span class="o">=</span> <span class="nv">$$pointer</span><span class="p">;</span>
	<span class="nv">$$pointer</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>
	<span class="k">return</span> <span class="nv">$data</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1"># Subroutine to post data via a http POST</span>
<span class="k">sub </span><span class="nf">httpPost</span> <span class="p">{</span>

	<span class="c1"># Get the subroutine arguments</span>
	<span class="k">my</span> <span class="nv">$settings_ref</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$url</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$httpHeaders_ref</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$data</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>

	<span class="k">print</span><span class="p">(</span><span class="s">'Entering httpPost             :\n'</span><span class="p">)</span>         <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span><span class="p">;</span>

	<span class="c1"># local varables</span>
	<span class="k">my</span> <span class="nv">$body</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$header</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$response_body</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$response_code</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$response_content_type</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$response_url</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>

	<span class="k">my</span> <span class="nv">$curl</span> <span class="o">=</span> <span class="nn">WWW::Curl::</span><span class="n">Easy</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">;</span>

	<span class="c1"># set options for the curl http request</span>
	<span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">setopt</span><span class="p">(</span><span class="n">CURLOPT_HEADER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">setopt</span><span class="p">(</span><span class="n">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="nv">$httpHeaders_ref</span> <span class="p">);</span>
	<span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">setopt</span><span class="p">(</span><span class="n">CURLOPT_POST</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">setopt</span><span class="p">(</span><span class="n">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nv">$data</span><span class="p">);</span>
	<span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">setopt</span><span class="p">(</span><span class="n">CURLOPT_POSTFIELDSIZE</span><span class="p">,</span> <span class="nb">length</span><span class="p">(</span><span class="nv">$data</span><span class="p">))</span> <span class="p">;</span>
	<span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">setopt</span><span class="p">(</span><span class="n">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
	<span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">setopt</span><span class="p">(</span><span class="n">CURLOPT_USERNAME</span><span class="p">,</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">username</span><span class="p">});</span>
	<span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">setopt</span><span class="p">(</span><span class="n">CURLOPT_PASSWORD</span><span class="p">,</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">password</span><span class="p">});</span>

	<span class="c1">#debugging</span>
	<span class="c1">#$curl-&gt;setopt (CURLOPT_VERBOSE, 1);</span>

	<span class="c1"># A filehandle, reference to a scalar or reference to a typeglob can be used here.</span>
	<span class="nb">open</span> <span class="k">my</span> <span class="nv">$fh</span><span class="p">,</span> <span class="s">'&gt;:encoding(UTF-8)'</span><span class="p">,</span> <span class="o">\</span><span class="nv">$response_body</span> <span class="ow">or</span> <span class="nb">die</span> <span class="s">"$!"</span><span class="p">;</span>
	<span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">setopt</span><span class="p">(</span><span class="n">CURLOPT_WRITEDATA</span><span class="p">,</span> <span class="nv">$fh</span><span class="p">);</span>

	<span class="c1"># Do the actual curl http request</span>
	<span class="k">my</span> <span class="nv">$returncode</span> <span class="o">=</span> <span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">perform</span><span class="p">;</span>

	<span class="c1"># close file handle</span>
	<span class="nb">close</span><span class="p">(</span><span class="nv">$fh</span><span class="p">);</span>

	<span class="c1"># Looking at the results of the curl request</span>
	<span class="k">if</span> <span class="p">(</span><span class="nv">$returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">print</span><span class="p">(</span><span class="s">'Transfer went ok\n'</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
		<span class="nv">$response_code</span>         <span class="o">=</span> <span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">getinfo</span><span class="p">(</span><span class="n">CURLINFO_HTTP_CODE</span><span class="p">);</span>
		<span class="nv">$response_content_type</span> <span class="o">=</span> <span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">getinfo</span><span class="p">(</span><span class="n">CURLINFO_CONTENT_TYPE</span><span class="p">);</span>
		<span class="k">print</span><span class="p">(</span><span class="s">"Received response code        : $response_code\n"</span><span class="p">)</span>         <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span><span class="p">;</span>
		<span class="k">print</span><span class="p">(</span><span class="s">"Received response content type: $response_content_type\n"</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span><span class="p">;</span>

		<span class="c1"># judge result and next action based on $response_code</span>
		<span class="k">if</span> <span class="p">(</span><span class="nv">$response_code</span> <span class="o">&gt;=</span> <span class="mi">200</span> <span class="o">&amp;&amp;</span> <span class="nv">$response_code</span> <span class="o">&lt;</span> <span class="mi">300</span> <span class="p">)</span> <span class="p">{</span>
			<span class="k">print</span><span class="p">(</span><span class="s">'The request went ok\n'</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
			<span class="k">print</span><span class="p">(</span><span class="s">"$response_body\n"</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span><span class="p">;</span>
			<span class="nb">open</span> <span class="k">my</span> <span class="nv">$fh</span><span class="p">,</span> <span class="s">'&lt;:encoding(UTF-8)'</span><span class="p">,</span> <span class="o">\</span><span class="nv">$response_body</span> <span class="ow">or</span> <span class="nb">die</span> <span class="s">"$!"</span><span class="p">;</span>
			<span class="k">while</span> <span class="p">(</span><span class="k">my</span> <span class="nv">$row</span> <span class="o">=</span> <span class="sr">&lt;$fh&gt;</span><span class="p">)</span> <span class="p">{</span>
				<span class="nb">chomp</span> <span class="nv">$row</span><span class="p">;</span>
				<span class="k">print</span> <span class="s">"row: $row\n"</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span> <span class="nv">$row</span> <span class="o">=~</span><span class="sr"> /^Location/</span> <span class="p">)</span> <span class="p">{</span>
					<span class="nv">$response_url</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span>
					<span class="nv">$response_url</span> <span class="o">=~</span> <span class="sr">s/^Location: //</span> <span class="p">;</span>
					<span class="k">print</span><span class="p">(</span><span class="s">"Received response url         : $response_url\n"</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span><span class="p">;</span>
					<span class="k">last</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>

		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="k">print</span><span class="p">(</span><span class="s">'The request went NOT ok\n'</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
			<span class="k">print</span><span class="p">(</span><span class="s">"$response_code\n"</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span><span class="p">;</span>
		<span class="p">}</span> 

	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="c1"># Error code, type of error, error message</span>
		<span class="k">print</span><span class="p">(</span><span class="s">"An error happened: $returncode "</span><span class="o">.</span><span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">strerror</span><span class="p">(</span><span class="nv">$returncode</span><span class="p">)</span><span class="o">.</span><span class="s">" "</span><span class="o">.</span><span class="nv">$curl</span><span class="o">-&gt;</span><span class="n">errbuf</span><span class="o">.</span><span class="s">"\n"</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="c1"># Return the results</span>
	<span class="k">return</span><span class="p">(</span><span class="nv">$returncode</span><span class="p">,</span> <span class="nv">$response_code</span><span class="p">,</span> <span class="nv">$response_content_type</span><span class="p">,</span> <span class="nv">$response_url</span> <span class="p">);</span>
<span class="p">}</span>

<span class="c1"># Subroutine to get and check all script arguments</span>
<span class="k">sub </span><span class="nf">get_arguments</span> <span class="p">{</span>

	<span class="c1"># Get the subroutine arguments</span>
	<span class="k">my</span> <span class="nv">$settings_ref</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>

	<span class="c1"># Define local variables</span>
	<span class="k">my</span> <span class="nv">%arguments</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$username</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$password</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$baseUri</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$pidUrl</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$credentials</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$handleData</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$type</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$header</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$returncode</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">$message</span><span class="p">;</span>
	<span class="k">my</span> <span class="nv">@sources</span><span class="p">;</span>

	<span class="n">GetOptions</span><span class="p">(</span> <span class="s">'h|help'</span>    <span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$arguments</span><span class="p">{</span><span class="n">help</span><span class="p">},</span>
		<span class="s">'user=s'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$username</span><span class="p">,</span>
		<span class="s">'passwd=s'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$password</span><span class="p">,</span>
		<span class="s">'base=s'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$baseUri</span><span class="p">,</span>
		<span class="s">'pid=s'</span>			<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$pidUrl</span><span class="p">,</span>
		<span class="s">'cred=s'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$credentials</span><span class="p">,</span>
		<span class="s">'data=s'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$handleData</span><span class="p">,</span>
		<span class="s">'type=s'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$type</span><span class="p">,</span>
		<span class="s">'header=s'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$header</span><span class="p">,</span>
		<span class="s">'get'</span>			<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$arguments</span><span class="p">{</span><span class="n">get</span><span class="p">},</span>
		<span class="s">'put'</span>			<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$arguments</span><span class="p">{</span><span class="n">put</span><span class="p">},</span>
		<span class="s">'delete'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$arguments</span><span class="p">{</span><span class="nb">delete</span><span class="p">},</span>
		<span class="s">'post'</span>			<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$arguments</span><span class="p">{</span><span class="n">post</span><span class="p">},</span>
		<span class="s">'pretty'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$arguments</span><span class="p">{</span><span class="n">pretty</span><span class="p">},</span>
		<span class="s">'d|debug'</span>		<span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$arguments</span><span class="p">{</span><span class="n">debug</span><span class="p">},</span>
	<span class="p">);</span>

	<span class="c1"># Check the help flag</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$arguments</span><span class="p">{</span><span class="n">help</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

		<span class="c1"># Set the returncode</span>
		<span class="nv">$returncode</span><span class="o">=</span><span class="mi">255</span><span class="p">;</span>

		<span class="nv">$message</span> <span class="o">=</span> <span class="n">print_help</span><span class="p">();</span>
	<span class="p">}</span>
	
	<span class="c1"># Check the debug flag</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$arguments</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=</span> <span class="s">'True'</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">'debug is                      : on\n'</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span>

	<span class="c1"># Check the pretty flag</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$arguments</span><span class="p">{</span><span class="n">pretty</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="nb">format</span><span class="p">}</span> <span class="o">=</span> <span class="s">'pretty'</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">'pretty format printing is     : on\n'</span><span class="p">)</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span>

	<span class="c1"># Check the action flag's (get,put,delete,post,search,nagios)</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$arguments</span><span class="p">{</span><span class="n">get</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">action</span><span class="p">}</span> <span class="o">=</span> <span class="s">'get'</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The action is                 : %s\n"</span><span class="p">,</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">action</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span> <span class="k">elsif</span> <span class="p">(</span> <span class="nv">$arguments</span><span class="p">{</span><span class="n">put</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">action</span><span class="p">}</span> <span class="o">=</span> <span class="s">'put'</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The action is                 : %s\n"</span><span class="p">,</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">action</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span> <span class="k">elsif</span> <span class="p">(</span> <span class="nv">$arguments</span><span class="p">{</span><span class="nb">delete</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">action</span><span class="p">}</span> <span class="o">=</span> <span class="s">'delete'</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The action is                 : %s\n"</span><span class="p">,</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">action</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span> <span class="k">elsif</span> <span class="p">(</span> <span class="nv">$arguments</span><span class="p">{</span><span class="n">post</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">action</span><span class="p">}</span> <span class="o">=</span> <span class="s">'post'</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The action is                 : %s\n"</span><span class="p">,</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">action</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span>

	<span class="c1"># check the username</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$username</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">username</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$username</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The username is               : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">username</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span>

	<span class="c1"># check the password</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$password</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">password</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$password</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The password is               : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">password</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span>

	<span class="c1"># check the base uri</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$baseUri</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">baseuri</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$baseUri</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The base uri is               : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">baseuri</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span>

	<span class="c1"># check the pid url</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$pidUrl</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">url</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">pid</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$pidUrl</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The pid is                    : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">url</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">pid</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
	
	<span class="p">}</span>

	<span class="c1"># check the handle data</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$handleData</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">data</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">putpost</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$handleData</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The data is                   : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">data</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">putpost</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
	
	<span class="p">}</span>

	<span class="c1"># check the type data</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$type</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">type</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$type</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The type(s) to show is/are    : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">type</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>

	<span class="p">}</span>
	
	<span class="c1"># check the header data</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$header</span> <span class="p">)</span> <span class="p">{</span>

		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">headerextra</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$header</span><span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The extra header info is      : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">headerextra</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
	
	<span class="p">}</span>

	<span class="c1"># check the credentials data</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$credentials</span> <span class="p">)</span> <span class="p">{</span>

		<span class="c1"># read the credentials from the file</span>
		<span class="k">my</span> <span class="nv">$filename</span> <span class="o">=</span> <span class="nv">$credentials</span><span class="p">;</span>
		<span class="k">my</span> <span class="nv">$json_text</span> <span class="o">=</span> <span class="k">do</span> <span class="p">{</span>
			<span class="nb">open</span><span class="p">(</span><span class="k">my</span> <span class="nv">$json_fh</span><span class="p">,</span> <span class="s">"&lt;:encoding(UTF-8)"</span><span class="p">,</span> <span class="nv">$filename</span><span class="p">)</span>  <span class="ow">or</span> <span class="nb">die</span><span class="p">(</span><span class="s">"Can't open $filename: $!\n"</span><span class="p">);</span>
			<span class="nb">local</span> <span class="vg">$/</span><span class="p">;</span>
			<span class="sr">&lt;$json_fh&gt;</span>
		<span class="p">};</span>

		<span class="c1"># convert from json and put in correct place </span>
		<span class="k">my</span> <span class="nv">$json</span> <span class="o">=</span> <span class="n">JSON</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">;</span>
		<span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$json</span><span class="o">-&gt;</span><span class="n">decode</span><span class="p">(</span><span class="nv">$json_text</span><span class="p">);</span>

		<span class="nb">printf</span><span class="p">(</span><span class="s">"The username is               : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">username</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The password is               : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">password</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
		<span class="nb">printf</span><span class="p">(</span><span class="s">"The base uri is               : %s\n"</span><span class="p">,</span><span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">handle</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">credentials</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">baseuri</span><span class="p">})</span> <span class="k">if</span> <span class="nv">$settings_ref</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">debug</span><span class="p">}</span> <span class="o">=~</span><span class="sr"> /True/</span> <span class="p">;</span>
	<span class="p">}</span>

	<span class="c1"># Print the message</span>
	<span class="k">if</span><span class="p">(</span> <span class="nv">$message</span> <span class="p">)</span> <span class="p">{</span>

		<span class="k">print</span> <span class="s">"$message\n"</span><span class="p">;</span>
	<span class="p">};</span>

	<span class="c1"># Return the results</span>
	<span class="k">return</span><span class="p">(</span><span class="nv">$returncode</span><span class="p">);</span>

<span class="p">};</span></code></pre>

	 </div>
	
</div>
	
		
			<h4 id="the-result">The Result</h4>

<p>The result of the automatic generation</p>

<p><span class="txtcenter"><strong>GRNET-0000-0000-000A-5-TEST </strong></span></p>

<h2 id="manual-generation-of-suffix">Manual generation of SUFFIX</h2>

<p>Its up to the user to decide the names of the PIDs. You may use</p>

<ul>
  <li>a number</li>
  <li>a string</li>
  <li>a UUID </li>
  <li>a pattern based on the community context</li>
</ul>

<p>In all examples in this manual we use a UUID generator.</p>

		
	

 <!--end item[:slug]-->
 </div>


    <div id="js-sidebar" class="sidebar-shell">
      <div class="sidebar-module">
        <ul>
          <li><h3><a href="/guides/overview">Overview</a></h3></li>
          <li><h3><a href="/guides/glossary/">Glossary</a></h3></li>
          <li><h3><a href="#">API</a></h3></li>
          <li><ul>
                <li><h3><a href="/guides/api/">Getting Started</a></h3></li>
                <li><h3><a href="/guides/api-auth/">Authenticate</a></h3></li>
                <li><h3><a href="/guides/api-generation/">PID Generation</a></h3></li>
                <li><h3><a href="/guides/api-get/">Get a PID</a></h3></li>
                <li><h3><a href="/guides/api-list/">List all PID</a></h3></li>
                <li><h3><a href="/guides/api-search/">Search</a></h3></li>
                <li><h3><a href="/guides/api-create/">Create a PID</a></h3></li>
                <li><h3><a href="/guides/api-update/">Update a PID</a></h3></li>
                <li><h3><a href="/guides/api-delete/">Delete a PID</a></h3></li>
                <li><h3><a href="/guides/api-partial/">Part Identifiers</a></h3></li>
          </ul></li>
        </ul> 
      </div>
      <div class="sidebar-module notice padding10">
          <strong>Service Url:</strong>
          <span class="txtcenter"> https://epic.grnet.gr/api/v2/handles/ </span>
      </div><!--sidebar-module-->
	</div>
  </div><!-- #wrapper -->

  	<div id="footer" >
    <div class="lower_footer">
      <ul class="footer-cell">
	
      </ul>

      <span class="footer-cell">
        <a href="http://www.grnet.gr"><img src="/shared/images/grnet-logo.jpg" alt='GRNET'/></a>
      </span>

      <ul class="footer-cell">
	
      </ul>
    </div>

  </div><!-- /#footer -->

</body>
</html>


